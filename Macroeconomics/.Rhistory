pib_tot<-sum(dados[,2])
pib_tot
sprintf("O PIB total entre %s e %s foi de US$%s Bilhoes",dados[1,1], dados[50,1],round(pib_tot,2))
#c)População Brasil
pop_tot<-sum(dados[,3])
pop_tot
sprintf("O População total do Brasil entre %s e %s foi de %s Milhoes de habitantes",dados[1,1], dados[50,1],round(pop_tot,2))
md<-lm(Con.Energia ~ PIB+POP, dados)
summary(md)
sprintf('Os resultados obtido no modelo de regressão Consumo=a+b*PIB+c*POP com os dados para cada coeficiente foram intercepto: %s, beta1: %s, beta2: %s', round(md[[1]][1],3), round(md[[1]][2],3), round(md[[1]][3],3))
#IV
md2<-lm(Con.Energia ~ Ano, dados)
summary(md2)
predict(md2, newdata = data.frame(Ano = 2030))
ybc<-md2[[1]][1]+md2[[1]][2]*2030
ybc
p= 970,87+915,14+862,61+813,09+766,42+1885,19+1776,97+1674,97+1578,82+1488,19
p
p= 970.87+915.14+862.61+813.09+766.42+1885.19+1776.97+1674.97+1578.82+1488.19
p
35*12
VP1= 3000*((1+0,0167)^6-1)/0,0167
VP1= 3000*((1+0.0167)^6-1)/0.0167
VP2= 20000*(1+((1+0.0508)^1-1)/((1+0.0508)^1*0.0508))
VP1
VP2
(1.12^10-1)/(1.12^10*0,12)
(1.12^10-1)/(1.12^10*0.12)
library(tidyverse)
library(readr)
library(dplyr)
library(stringr)
library(lubridate)
library(purrr)
library(ggplot2)
library(mFilter)
industria<-readr::read_csv("~/MeusProjetos/R_Study_cases/Macroeconomics/horas trabalhadas.csv"
,col_names = TRUE)
industria<-as_tibble(industria)
industria<- industria %>%
select(-`...3`)%>%
rename(Horas_Trabalhadas = `Indicadores Industriais - horas trabalhadas - indústria - índice dessazonalizado (média 2006 = 100) - - - Confederação Nacional da Indústria - CNI12_HTRABD12` ) %>%
mutate(Data= ym(format(as.Date(paste0(Data, ".01"), format = "%Y.%m.%d"), "%Y-%m")),
Horas_Trabalhadas = as.numeric(Horas_Trabalhadas))
industria<- industria %>%
mutate(Data = floor_date(Data, "quarter")) %>%
group_by(Data) %>%
summarise(Horas_Trabalhadas = log(mean(Horas_Trabalhadas, na.rm = TRUE)))%>%
slice(-c(1:16))
plot.ts(industria$Horas_Trabalhadas)
apu <- readr::read_csv2("~/MeusProjetos/R_Study_cases/Macroeconomics/APU .csv",
col_names = TRUE)
apu<-as.tibble(apu)
apu<- apu%>%
rename(Adm_Pub = colnames(apu[,2])) %>%
mutate(Data = yq(Data),
Adm_Pub = log(as.numeric(Adm_Pub)))
plot.ts(apu$Adm_Pub)
fbcf <- readr::read_csv("~/MeusProjetos/R_Study_cases/Macroeconomics/Formação bruta de capital.csv"
,col_names = TRUE)
fbcf <- as.tibble(fbcf)
fbcf <- fbcf %>%
select(-`...3`)%>%
rename(Capital_Fixo = colnames(fbcf[,2]))%>%
mutate(Data  = yq(Data), Capital_Fixo = log(as.numeric(Capital_Fixo)))
plot.ts(fbcf$Capital_Fixo)
fam<- readr::read_csv("~/MeusProjetos/R_Study_cases/Macroeconomics/Consumo final- Familias.csv"
,col_names = TRUE)
fam<-as.tibble(fam)
fam<- fam %>%
select(-`...3`)%>%
rename(Cons_Familias = colnames(fam[,2]))%>%
mutate(Data = yq(Data), Cons_Familias = log(as.numeric(Cons_Familias)))
plot.ts(fam$Cons_Familias)
pib<- readr::read_csv("~/MeusProjetos/R_Study_cases/Macroeconomics/PIB - preços de mercado.csv"
,col_names = TRUE)
pib<-as.tibble(pib)
pib<- pib %>%
select(-`...3`)%>%
rename(PIB_Nominal = colnames(pib[,2]))%>%
mutate(Data = yq(Data), PIB_Nominal = log(as.numeric(PIB_Nominal)))
plot.ts(pib$PIB_Nominal)
hp_industria <- hpfilter(industria, freq = 1600)
View(industria)
ts(industria$Horas_Trabalhadas, start = c(1996,1), frequency = 4)
hp_industria <- hpfilter(ts(industria$Horas_Trabalhadas
, start = c(1996,1), frequency = 4), freq = 1600)
View(hp_industria)
hp_pib <- hpfilter(ts(pib$PIB_Nominal
, start = c(1996,1), frequency = 4), freq = 1600)
hp_fbcf<- hpfilter(ts(fbcf$Capital_Fixo
, start = c(1996,1), frequency = 4), freq = 1600)
hp_fam<- hpfilter(ts(fam$Cons_Familias
, start = c(1996,1), frequency = 4), freq = 1600)
hp_apu<- hpfilter(ts(apu$Adm_Pub
, start = c(1996,1), frequency = 4), freq = 1600)
View(hp_industria)
View(industria)
industria<- industria %>%
mutate(trend = hp_industria$trend, cycle = hp_industria$cycle)%$>%
ggplot(industria,aes(x = c(Horas_Trabalhadas,trend), y= Data))+
geom_line(linewith = 1.3, linetype= 1)
industria<- industria %>%
mutate(trend = hp_industria$trend, cycle = hp_industria$cycle)%>%
ggplot(industria,aes(x = c(Horas_Trabalhadas,trend), y= Data))+
geom_line(linewith = 1.3, linetype= 1)
industria<- industria %>%
mutate(trend = hp_industria$trend, cycle = hp_industria$cycle)%>%
ggplot(aes(x = c(Horas_Trabalhadas,trend), y= Data))+
geom_line(linewith = 1.3, linetype= 1)
industria<- industria %>%
mutate(trend = hp_industria$trend, cycle = hp_industria$cycle)%>%
ggplot(aes(x = c(Horas_Trabalhadas,trend), y= Data))+
geom_line(linewidth = 1.3, linetype= 1)
industria<- industria %>%
mutate(trend = hp_industria$trend, cycle = hp_industria$cycle) %>%
ggplot(aes(x = c(Horas_Trabalhadas,trend), y= Data))+
geom_line(linewidth = 1.3, linetype= 1)
industria<- industria %>%
mutate(trend = hp_industria$trend, cycle = hp_industria$cycle) %>%
ggplot(aes(x = Data))+
geom_line(aes(y= Horas_Trabalhadas)) +
geom_line(aes(y = trend), linetype = 'dashed')+
labs(title = "Horas Trabalhadas - Industria",
x = "Trimestre")+
theme_classic()
industria<- industria %>%
mutate(trend = hp_industria$trend, cycle = hp_industria$cycle)
View(industria)
industria<-readr::read_csv("~/MeusProjetos/R_Study_cases/Macroeconomics/horas trabalhadas.csv"
,col_names = TRUE)
industria<-as_tibble(industria)
industria<- industria %>%
select(-`...3`)%>%
rename(Horas_Trabalhadas = `Indicadores Industriais - horas trabalhadas - indústria - índice dessazonalizado (média 2006 = 100) - - - Confederação Nacional da Indústria - CNI12_HTRABD12` ) %>%
mutate(Data= ym(format(as.Date(paste0(Data, ".01"), format = "%Y.%m.%d"), "%Y-%m")),
Horas_Trabalhadas = as.numeric(Horas_Trabalhadas))
industria<- industria %>%
mutate(Data = floor_date(Data, "quarter")) %>%
group_by(Data) %>%
summarise(Horas_Trabalhadas = log(mean(Horas_Trabalhadas, na.rm = TRUE)))%>%
slice(-c(1:16))
plot.ts(industria$Horas_Trabalhadas)
industria<- industria %>%
mutate(trend = hp_industria$trend, cycle = hp_industria$cycle)
industria %>%
ggplot(aes(x = Data))+
geom_line(aes(y= Horas_Trabalhadas)) +
geom_line(aes(y = trend), linetype = 'dashed')+
labs(title = "Horas Trabalhadas - Industria",
x = "Trimestre")+
theme_classic()
industria %>%
ggplot(aes(x = Data))+
geom_line(aes(y= Horas_Trabalhadas), color = 'Horas Trabalhadas', linewidth= 1.3) +
geom_line(aes(y = trend), linetype = 'dashed', linewidth= 1.3)+
labs(title = "Horas Trabalhadas - Industria",
x = "Trimestre",
y = "",
Color = "Legenda")+
theme_classic()
industria %>%
ggplot(aes(x = Data))+
geom_line(aes(y= Horas_Trabalhadas), color = 'Horas_Trabalhadas', linewidth= 1.3) +
geom_line(aes(y = trend), linetype = 'dashed', linewidth= 1.3)+
labs(title = "Horas Trabalhadas - Industria",
x = "Trimestre",
y = "",
Color = "Legenda")+
theme_classic()
industria %>%
ggplot(aes(x = Data))+
geom_line(aes(y= Horas_Trabalhadas), color = Horas_Trabalhadas, linewidth= 1.3) +
geom_line(aes(y = trend), linetype = 'dashed', linewidth= 1.3)+
labs(title = "Horas Trabalhadas - Industria",
x = "Trimestre",
y = "",
Color = "Legenda")+
theme_classic()
View(industria)
hp_industria[["trend"]]
industria %>%
ggplot(aes(x = Data))+
geom_line(aes(y= Horas_Trabalhadas), color = "Horas Trabalhadas", linewidth= 1.3) +
geom_line(aes(y = trend), linetype = 'dashed', linewidth= 1.3)+
labs(title = "Horas Trabalhadas - Industria",
x = "Trimestre",
y = "",
Color = "Legenda")+
theme_classic()
industria %>%
ggplot(aes(x = Data))+
geom_line(aes(y= Horas_Trabalhadas), color = 'blue', linewidth= 1.3) +
geom_line(aes(y = trend), linetype = 'dashed', linewidth= 1.3)+
labs(title = "Horas Trabalhadas - Industria",
x = "Trimestre",
y = "",
Color = "Legenda")+
theme_classic()
industria %>%
ggplot(aes(x = Data))+
geom_line(aes(y= Horas_Trabalhadas), color = 'blue', linewidth= 1.2) +
geom_line(aes(y = trend), linetype = 'dashed', linewidth= 1.2)+
labs(title = "Horas Trabalhadas - Industria",
x = "Trimestre",
y = "",
Color = "Legenda")+
theme_classic()
industria %>%
ggplot(aes(x = Data), color = )+
geom_line(aes(y= Horas_Trabalhadas), color = 'blue', linewidth= 1.2) +
geom_line(aes(y = trend), linetype = 'dashed', linewidth= 1.2)+
labs(title = "Horas Trabalhadas - Industria",
x = "Trimestre",
y = "",
Color = )+
theme_classic()
industria %>%
ggplot(aes(x = Data), color = Horas_Trabalhadas)+
geom_line(aes(y= Horas_Trabalhadas), color = 'blue', linewidth= 1.2) +
geom_line(aes(y = trend), linetype = 'dashed', linewidth= 1.2)+
labs(title = "Horas Trabalhadas - Industria",
x = "Trimestre",
y = "",
Color = )+
theme_classic()
industria %>%
ggplot(aes(x = Data))+
geom_line(aes(y= Horas_Trabalhadas), color = 'blue', linewidth= 1.2) +
geom_line(aes(y = trend), linetype = 'dashed', linewidth= 1.2)+
labs(title = "Horas Trabalhadas - Industria",
x = "Trimestre",
y = "",
Color = )+
theme_classic()
industria %>%
ggplot(aes(x = Data), color = Horas_Trabalhadas)+
geom_line(aes(y= Horas_Trabalhadas), color = 'blue', linewidth= 1.2) +
geom_line(aes(y = trend), linetype = 'dashed', linewidth= 1.2)+
labs(title = "Horas Trabalhadas - Industria",
x = "Trimestre",
y = "",
Color = "Legenda")+
theme_classic()
industria %>%
ggplot(aes(x = Data), color = Horas_Trabalhadas)+
geom_line(aes(y= Horas_Trabalhadas), color = 'blue', linewidth= 1.2) +
geom_line(aes(y = trend), linetype = 'dashed',color = "tendência", linewidth= 1.2)+
labs(title = "Horas Trabalhadas - Industria",
x = "Trimestre",
y = "",
Color = "Legenda")+
theme_classic()
industria %>%
ggplot(aes(x = Data), color = Horas_Trabalhadas)+
geom_line(aes(y= Horas_Trabalhadas), color = 'blue', linewidth= 1.2) +
geom_line(aes(y = trend), linetype = 'dashed',color = "tendência", linewidth= 1.2)+
labs(title = "Horas Trabalhadas - Industria",
x = "Trimestre",
y = "",
Color = "Legenda")+
theme_classic()
industria %>%
ggplot(aes(x = Data), color = Horas_Trabalhadas)+
geom_line(aes(y= Horas_Trabalhadas), color = 'blue', linewidth= 1.2) +
geom_line(aes(y = trend), linetype = 'dashed',color = "darkgrey", linewidth= 1.2)+
labs(title = "Horas Trabalhadas - Industria",
x = "Trimestre",
y = "",
Color = "Legenda")+
theme_classic()
industria %>%
ggplot(aes(x = Data), color = Horas_Trabalhadas)+
geom_line(aes(y= Horas_Trabalhadas), color = 'blue', linewidth= 1.2) +
geom_line(aes(y = trend), linetype = 'dashed', linewidth= 1.2)+
labs(title = "Horas Trabalhadas - Industria",
x = "Trimestre",
y = "",
Color = "Legenda")+
theme_classic()
industria %>%
ggplot(aes(x = Data))+
geom_line(aes(y= Horas_Trabalhadas, color = "Horas Trabalhadas"), color = 'blue', linewidth= 1.2) +
geom_line(aes(y = trend, color = "Tendência"), linetype = 'dashed', linewidth= 1.2)+
labs(title = "Horas Trabalhadas - Industria",
x = "Trimestre",
y = "",
Color = "Legenda")+
theme_classic()
industria %>%
ggplot(aes(x = Data))+
geom_line(aes(y= Horas_Trabalhadas, color = "Horas Trabalhadas"), linewidth= 1.2) +
geom_line(aes(y = trend, color = "Tendência"), linetype = 'dashed', linewidth= 1.2)+
labs(title = "Horas Trabalhadas - Industria",
x = "Trimestre",
y = "",
Color = "Legenda")+
theme_classic()
industria %>%
ggplot(aes(x = Data))+
geom_line(aes(y= Horas_Trabalhadas, color = "Horas Trabalhadas"), linewidth= 1.2) +
geom_line(aes(y = trend, color = "Tendência"), linetype = 'dashed', linewidth= 1.2)+
labs(title = "Horas Trabalhadas - Industria",
x = "Trimestre",
y = "",
Color = "Cores")+
theme_classic()
industria %>%
ggplot(aes(x = Data))+
geom_line(aes(y= Horas_Trabalhadas, color = "Horas Trabalhadas"), linewidth= 1.2) +
geom_line(aes(y = trend, color = "Tendência"), linetype = 'dashed', linewidth= 1.2)+
labs(title = "Horas Trabalhadas - Industria",
x = "Trimestre",
y = "")+
theme_minimal(
base_size = 13,
base_family = "serif"
)
industria %>%
ggplot(aes(x = Data))+
geom_line(aes(y= Horas_Trabalhadas, color = "Horas Trabalhadas"), linewidth= 1.2) +
geom_line(aes(y = trend, color = "Tendência"), linetype = 'dashed', linewidth= 1.2)+
labs(title = "Horas Trabalhadas - Industria",
x = "Trimestre",
y = "")+
theme_minimal(
base_size = 13,
base_family = "serif"
)+
theme(plot.title = element_text(size = 20, hjust = 0.5))
getwd()
setwd("C:\Users\Arthu\OneDrive\Documentos\MeusProjetos\R_Study_cases\Macroeconomics")
setwd("C:/Users/Arthu/OneDrive/Documentos/MeusProjetos/R_Study_cases/Macroeconomics")
getwd()
ggsave("horas_trabalhadasXtêndencia.png", plot = grafico, width = 8, height = 6, dpi = 500)
htXtd<- industria %>%
ggplot(aes(x = Data))+
geom_line(aes(y= Horas_Trabalhadas, color = "Horas Trabalhadas"), linewidth= 1.2) +
geom_line(aes(y = trend, color = "Tendência"), linetype = 'dashed', linewidth= 1.2)+
labs(title = "Horas Trabalhadas - Industria",
x = "Trimestre",
y = "")+
theme_minimal(
base_size = 13,
base_family = "serif"
)+
theme(plot.title = element_text(size = 20, hjust = 0.5))
ggsave("horas_trabalhadasXtêndencia.png", plot = grafico, width = 8, height = 6, dpi = 500)
ggsave("horas_trabalhadasXtêndencia.png", plot = htXtd, width = 8, height = 6, dpi = 500)
ggsave("horas_trabalhadasXtêndencia.png", plot = htXtd, width = 8, height = 6, dpi = 300)
ggsave("horas_trabalhadasXtêndencia.png", plot = htXtd, width = 6, height = 4, dpi = 300)
pib<- pib %>%
mutate(trend = hp_pib$trend, cycle = hp_pib$cycle)
View(pib)
pibXtd<- pib %>%
ggplot(aes(x = Data))+
geom_line(aes(y= PIB_Nominal, color = "PIB Nominal"), linewidth= 1.2) +
geom_line(aes(y = trend, color = "Tendência"), linetype = 'dashed', linewidth= 1.2)+
labs(title = "PIB nominal à Preços de Mercado",
x = "Trimestre",
y = "")+
theme_minimal(
base_size = 13,
base_family = "serif"
)+
theme(plot.title = element_text(size = 20, hjust = 0.5))
ggsave("PIBXtêndencia.png", plot = pibXtd, width = 8, height = 6, dpi = 300)
pibXtd<- pib %>%
ggplot(aes(x = Data))+
geom_line(aes(y= PIB_Nominal, color = "PIB Nominal"), linewidth= 1.2) +
geom_line(aes(y = trend, color = "Tendência"), linetype = 'dashed', linewidth= 1.2)+
labs(title = "PIB nominal à Preços de Mercado",
x = "Trimestre",
y = "")+
theme_minimal(
base_size = 13,
base_family = "serif"
)+
theme(plot.title = element_text(size = 20, hjust = 0.5))
htXtd<- industria %>%
ggplot(aes(x = Data))+
geom_line(aes(y= Horas_Trabalhadas, color = "Horas Trabalhadas"), linewidth= 1.2) +
geom_line(aes(y = trend, color = "Tendência"), linetype = 'dashed', linewidth= 1.2)+
labs(title = "Horas Trabalhadas - Industria",
x = "Trimestre",
y = "")+
theme_minimal(
base_size = 13,
base_family = "serif"
)+
theme(plot.title = element_text(size = 20, hjust = 0.5))
ggsave("horas_trabalhadasXtêndencia.png", plot = htXtd, width = 8, height = 6, dpi = 300)
View(fbcf)
#Apicação a série de FBCF
fbcf<- fbcf %>%
mutate(trend = hp_fbcf$trend, cycle = hp_fbcf$cycle)
CFXtd<- pib %>%
ggplot(aes(x = Data))+
geom_line(aes(y= Capital_Fixo, color = "Capital Fixo"), linewidth= 1.2) +
geom_line(aes(y = trend, color = "Tendência"), linetype = 'dashed', linewidth= 1.2)+
labs(title = "Formação Bruta de Capital Fixo",
x = "Trimestre",
y = "")+
theme_minimal(
base_size = 13,
base_family = "serif"
)+
theme(plot.title = element_text(size = 20, hjust = 0.5))
ggsave("FBCFXtêndencia.png", plot = CFXtd, width = 8, height = 6, dpi = 300)
CFXtd<- fbcf %>%
ggplot(aes(x = Data))+
geom_line(aes(y= Capital_Fixo, color = "Capital Fixo"), linewidth= 1.2) +
geom_line(aes(y = trend, color = "Tendência"), linetype = 'dashed', linewidth= 1.2)+
labs(title = "Formação Bruta de Capital Fixo",
x = "Trimestre",
y = "")+
theme_minimal(
base_size = 13,
base_family = "serif"
)+
theme(plot.title = element_text(size = 20, hjust = 0.5))
ggsave("FBCFXtêndencia.png", plot = CFXtd, width = 8, height = 6, dpi = 300)
CFXtd<-
fbcf %>%
ggplot(aes(x = Data))+
geom_line(aes(y= Capital_Fixo, color = "Capital Fixo"), linewidth= 1.2) +
geom_line(aes(y = trend, color = "Tendência"), linetype = 'dashed', linewidth= 1.2)+
labs(title = "Formação Bruta de Capital Fixo",
x = "Trimestre",
y = "")+
theme_minimal(
base_size = 13,
base_family = "serif"
)+
theme(plot.title = element_text(size = 20, hjust = 0.5))
#CFXtd<-
fbcf %>%
ggplot(aes(x = Data))+
geom_line(aes(y= Capital_Fixo, color = "Capital Fixo"), linewidth= 1.2) +
geom_line(aes(y = trend, color = "Tendência"), linetype = 'dashed', linewidth= 1.2)+
labs(title = "Formação Bruta de Capital Fixo",
x = "Trimestre",
y = "")+
theme_minimal(
base_size = 13,
base_family = "serif"
)+
theme(plot.title = element_text(size = 20, hjust = 0.5))
View(fam)
View(fam)
#Aplicação a despesas das familias
fam<- fam %>%
mutate(trend = hp_fam$trend, cycle = hp_fam$cycle)
DFXtd<- fam %>%
ggplot(aes(x = Data))+
geom_line(aes(y= Cons_Familias, color = "Consumo das Familias"), linewidth= 1.2) +
geom_line(aes(y = trend, color = "Tendência"), linetype = 'dashed', linewidth= 1.2)+
labs(title = "Consumo das Familias",
x = "Trimestre",
y = "")+
theme_minimal(
base_size = 13,
base_family = "serif"
)+
theme(plot.title = element_text(size = 20, hjust = 0.5))
ggsave("DespFamXtêndencia.png", plot = DFXtd, width = 8, height = 6, dpi = 300)
#Aplicação a despesas públicas
apu<- apu %>%
mutate(trend = hp_apu$trend, cycle = hp_apu$cycle)
View(apu)
DPuXtd<- apu %>%
ggplot(aes(x = Data))+
geom_line(aes(y= Adm_Pub, color = "Despesa Pública"), linewidth= 1.2) +
geom_line(aes(y = trend, color = "Tendência"), linetype = 'dashed', linewidth= 1.2)+
labs(title = "Despesa da Administração Pública",
x = "Trimestre",
y = "")+
theme_minimal(
base_size = 13,
base_family = "serif"
)+
theme(plot.title = element_text(size = 20, hjust = 0.5))
ggsave("DPuXtêndencia.png", plot = DPuXtd, width = 8, height = 6, dpi = 300)
%>%
%>%
#Obtendo Componentes ciclicos
Cy_HT<- industria %>%
ggplot(aes(x = Data))+
geom_line(aes(y= cycle, color = "Despesa Pública"), linewidth= 1.2) +
labs(title = "Componente Ciclico das Horas Trabalhadas",
x = "Trimestre",
y = "")+
theme_minimal(
base_size = 13,
base_family = "serif"
)+
theme(plot.title = element_text(size = 20, hjust = 0.5))
ggsave("Cycle_industria.png", plot = Cy_HT, width = 8, height = 6, dpi = 300)
View(Cy_HT)
#Obtendo Componentes ciclicos
Cy_HT<- industria %>%
ggplot(aes(x = Data))+
geom_line(aes(y= cycle), color = 'blue', linewidth= 1.2) +
labs(title = "Componente Ciclico das Horas Trabalhadas",
x = "Trimestre",
y = "")+
theme_minimal(
base_size = 13,
base_family = "serif"
)+
theme(plot.title = element_text(size = 20, hjust = 0.5))
ggsave("Cycle_industria.png", plot = Cy_HT, width = 8, height = 6, dpi = 300)
